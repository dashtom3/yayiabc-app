{"version":3,"sources":["webpack:///static/js/82.d7a9c11eee4dd2d79d78.js","webpack:///./src/components/wx_user/user.vue?acf6","webpack:///./src/components/wx_user/user.vue?b512","webpack:///./src/components/wx_user/user.vue","webpack:///user.vue","webpack:///./src/components/wx_user/user.vue?e771"],"names":["webpackJsonp","1133","module","exports","__webpack_require__","content","i","locals","1359","render","_vm","this","_h","$createElement","_c","_self","staticClass","staticRenderFns","335","injectStyle","ssrContext","Component","952","__webpack_exports__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_mint_ui__","__WEBPACK_IMPORTED_MODULE_1__vuex_util__","n","__WEBPACK_IMPORTED_MODULE_2__vuex_types__","name","data","state","queryObj","openid","phone","isBindSale","isBind","role","entry","_salePhone","saleName","methods","goChildrenRoute","_this","goRouter","url","$router","replace","path","query","salePhone","token","message","duration","initQrcode","length","$route","bindEntry","toString","getQueryObj","window","location","search","split","$1","$2","$3","created","_this2","console","info","log","open","$store","dispatch","code","then","res","close","sNSUserInfo","openId","sign","wXUserLibk","type","user","saleinfo","trueName","saleInfo","setToken","catch","err","mounted","987","push","version","sources","names","mappings","file","sourcesContent","sourceRoot"],"mappings":"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","file":"static/js/82.d7a9c11eee4dd2d79d78.js","sourcesContent":["webpackJsonp([82],{\n\n/***/ 1133:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(987);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(243)(\"7c05a6c4\", content, true);\n\n/***/ }),\n\n/***/ 1359:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"user-container\"\n  }, [_c('div', {\n    staticClass: \"content\"\n  }, [_c('router-view')], 1)])\n},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 335:\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(1133)\n}\nvar Component = __webpack_require__(62)(\n  /* script */\n  __webpack_require__(952),\n  /* template */\n  __webpack_require__(1359),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-263ef3ca\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 952:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_mint_ui__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_mint_ui___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_mint_ui__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vuex_util__ = __webpack_require__(111);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__vuex_types__ = __webpack_require__(35);\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'wx_user',\n  data: function data() {\n    return {\n      state: 0,\n      queryObj: {},\n      openid: '',\n      phone: '',\n      isBindSale: false,\n      isBind: false,\n      role: '',\n      entry: '',\n      _salePhone: '',\n      saleName: ''\n    };\n  },\n\n  methods: {\n    //根据请求不同的state跳转不同的路由\n    goChildrenRoute: function goChildrenRoute(isBind) {\n      var _this = this;\n\n      //跳转路由方法\n      var goRouter = function goRouter(url) {\n        _this.$router.replace(url);\n      };\n      switch (true) {\n        //表示已经绑定了\n        case isBind:\n          goRouter({\n            path: '/wx_user/bindinfo',\n            query: {\n              role: this.role,\n              phone: this.phone,\n              salePhone: this.salePhone || this._salePhone,\n              //表示需要判断的绑定销售代表\n              isBindSale: this.isBindSale,\n              entry: this.entry,\n              //此token表示是从上一级路由传下来的或者从查看绑定接口去拿token,向绑定页面发送\n              token: this.token,\n              saleName: this.saleName\n            }\n          });\n          break;\n        //表示手机号和微信未绑定\n        case !isBind:\n          goRouter({\n            path: '/wx_user/userBindWx',\n            query: {\n              role: this.role,\n              openid: this.openid,\n              entry: this.entry,\n              salePhone: this.salePhone || this._salePhone\n            }\n          });\n          break;\n        default:\n          __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_mint_ui__[\"Toast\"])({ message: '登录失败请稍后重试！', duration: 3000 });\n          break;\n      }\n    },\n    initQrcode: function initQrcode() {\n      if (this.queryObj.state.length === 11 && this.$route.query.bindEntry !== 'qrcode') {\n        this.entry = 'qrcode';\n        this._salePhone = this.queryObj.state.toString();\n      }\n    },\n\n    //      goChildrenRoute(state) {\n    //        //跳转路由方法\n    //        let goRouter = (url) => {\n    //          this.$router.replace(url)\n    //        }\n    //        switch (state) {\n    //          case '未绑定手机号,未注册':\n    //            this.title = '绑定牙医abc账号'\n    //            goRouter({path: '/wx_user/login', query: {role: 'doctor', openid: this.openid}})\n    //            break\n    //          case '未绑定手机号,已注册':\n    //            this.title = '绑定牙医abc账号'\n    //            goRouter({path: '/wx_user/login', query: {role: 'doctor', openid: this.openid}})\n    //            break\n    //          case '已绑定手机号(未绑定销售)，牙医':\n    //            this.title = '绑定账号'\n    //            goRouter({\n    //              path: '/wx_user/bindinfo',\n    //              query: {\n    //                role: 'doctor',\n    //                phone: this.phone,\n    //                customerPhone: this.customerPhone,\n    //                openid: this.openid,\n    //                isBind: this.isBind\n    //              }\n    //            })\n    //            break\n    //          case '已绑定手机号(已绑定销售)，牙医':\n    //            this.title = '绑定账号'\n    //            goRouter({path: '/wx_user/bindinfo', query: {role: 'doctor', bindInfo, openid: this.openid}})\n    //            break\n    //          case '未绑定手机号(未注册)，客户代表':\n    //            this.title = '绑定账号'\n    //            goRouter({path: '/wx_user/login', query: {role: 'sale', openid: this.openid}})\n    //            break\n    //          case '未绑定手机号(已注册)，客户代表':\n    //            this.title = '绑定账号'\n    //            goRouter({path: '/wx_user/bindinfo', query: {role: 'sale', bindInfo, openid: this.openid}})\n    //            break\n    //          default:\n    //            Toast({message: '登录失败请稍后重试！', duration: 3000})\n    //            this.title = '登录失败请稍后重试'\n    //            break\n    //        }\n    //      },\n\n    //获取查询自符串并保存到queryObj对象中\n    getQueryObj: function getQueryObj() {\n      //获取为网页查询字符串\n      var queryObj = {};\n      var query = window.location.search.split('?')[1] || '';\n      query.replace(/(\\w+)=(\\w*)/g, function ($1, $2, $3) {\n        queryObj[$2] = $3;\n      });\n      this.queryObj = queryObj;\n    }\n  },\n  created: function created() {\n    var _this2 = this;\n\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_mint_ui__[\"Toast\"])({ message: '正在验证身份信息，请稍后', duration: 1000 });\n    //获取查询字符串中的code值\n    this.getQueryObj();\n    //扫码登录进来的\n    //      this.role = this.$route.query.role\n    //获得入口方式\n    this.initQrcode();\n    //判断入口\n    console.info('user组件中的query', this.$route.query);\n    if (this.$route.query.bindEntry === 'qrcode') {\n      this.entry = '';\n      //todo 验证这步是否出现问题\n      this.openid = this.$route.query.openid;\n      console.log(this.openid);\n      this.goChildrenRoute(this.isBind);\n    } else {\n      //请求微信openid值和绑定信息\n      __WEBPACK_IMPORTED_MODULE_0_mint_ui__[\"Indicator\"].open();\n      this.$store.dispatch(__WEBPACK_IMPORTED_MODULE_2__vuex_types__[\"f\" /* GET_USER_WX_STATE */], { code: this.queryObj.code }).then(function (res) {\n        __WEBPACK_IMPORTED_MODULE_0_mint_ui__[\"Indicator\"].close();\n        _this2.openid = res.data.sNSUserInfo.openId;\n        //表示微信已经和用户绑定\n        if (+res.data.sNSUserInfo.sign === 1) _this2.isBind = true;\n\n        if (_this2.isBind) {\n          //判断角色的两种doctor和sale\n          if (+res.data.wXUserLibk.type === 1) _this2.role = 'doctor';\n          if (+res.data.wXUserLibk.type === 2) _this2.role = 'sale';\n          //获取到用户的一些信息 data可能为空\n          var data = res.data.user;\n          if (data && data.saleinfo) _this2.isBindSale = true;\n          //TODO 这里写saleName\n          if (data && data.saleinfo) _this2.saleName = data.saleinfo.trueName || '未知';\n          if (data) {\n            _this2.salePhone = data.saleinfo && data.saleinfo.phone;\n            _this2.phone = data.phone;\n          }\n          if (_this2.role === 'sale') _this2.phone = res.data.saleInfo.phone;\n          __WEBPACK_IMPORTED_MODULE_1__vuex_util__[\"a\" /* tokenMethods */].setToken(res.token);\n          _this2.token = res.token;\n        }\n        //根据绑定信息跳转路由\n        _this2.goChildrenRoute(_this2.isBind);\n      }).catch(function (err) {\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_mint_ui__[\"Toast\"])({ message: '身份验证出现问题，请稍后', duration: 3000 });\n        console.log(err);\n        //          setTimeout(() => {\n        //            this.$router.go(-1)\n        //          }, 5000)\n      });\n    }\n  },\n  mounted: function mounted() {}\n});\n\n/***/ }),\n\n/***/ 987:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(242)(true);\n// imports\n\n\n// module\nexports.push([module.i, \".user-container[data-v-263ef3ca]{position:relative}.content[data-v-263ef3ca]{margin-top:6vh}\", \"\", {\"version\":3,\"sources\":[\"D:/yayiApp/src/components/wx_user/user.vue\"],\"names\":[],\"mappings\":\"AACA,iCACE,iBAAmB,CACpB,AACD,0BACE,cAAgB,CACjB\",\"file\":\"user.vue\",\"sourcesContent\":[\"\\n.user-container[data-v-263ef3ca] {\\n  position: relative;\\n}\\n.content[data-v-263ef3ca] {\\n  margin-top: 6vh;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/82.d7a9c11eee4dd2d79d78.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/_css-loader@0.28.7@css-loader/index.js?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-263ef3ca\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./user.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/_vue-style-loader@3.0.3@vue-style-loader/lib/addStylesClient.js\")(\"7c05a6c4\", content, true);\n\n\n// WEBPACK FOOTER //\n// \"}!./~/_vue-style-loader@3.0.3@vue-style-loader!./~/_css-loader@0.28.7@css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/_vue-loader@12.2.2@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-263ef3ca\",\"scoped\":true,\"hasInlineConfig\":false}!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./src/components/wx_user/user.vue","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"user-container\"\n  }, [_c('div', {\n    staticClass: \"content\"\n  }, [_c('router-view')], 1)])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_vue-loader@12.2.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-263ef3ca\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"}}!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/wx_user/user.vue\n// module id = 1359\n// module chunks = 82","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@2.1.2@extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-263ef3ca\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=styles&index=0!./user.vue\")\n}\nvar Component = require(\"!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=script&index=0!./user.vue\"),\n  /* template */\n  require(\"!!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-263ef3ca\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"}}!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=template&index=0!./user.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-263ef3ca\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/wx_user/user.vue\n// module id = 335\n// module chunks = 82","<template>\r\n  <div class=\"user-container\">\r\n    <div class=\"content\">\r\n      <router-view></router-view>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\n  import {Toast, Indicator,MessageBox} from 'mint-ui'\r\n  import {tokenMethods} from '../../vuex/util'\r\n  import {GET_USER_WX_STATE} from '../../vuex/types'\r\n\r\n  export default {\r\n    name: 'wx_user',\r\n    data() {\r\n      return {\r\n        state: 0,\r\n        queryObj: {},\r\n        openid: '',\r\n        phone: '',\r\n        isBindSale: false,\r\n        isBind: false,\r\n        role: '',\r\n        entry: '',\r\n        _salePhone: '',\r\n        saleName: ''\r\n      }\r\n    },\r\n    methods: {\r\n      //根据请求不同的state跳转不同的路由\r\n      goChildrenRoute(isBind) {\r\n        //跳转路由方法\r\n        let goRouter = (url) => {\r\n          this.$router.replace(url)\r\n        }\r\n        switch (true) {\r\n          //表示已经绑定了\r\n          case isBind:\r\n            goRouter({\r\n              path: '/wx_user/bindinfo',\r\n              query: {\r\n                role: this.role,\r\n                phone: this.phone,\r\n                salePhone: this.salePhone || this._salePhone,\r\n                //表示需要判断的绑定销售代表\r\n                isBindSale: this.isBindSale,\r\n                entry: this.entry,\r\n                //此token表示是从上一级路由传下来的或者从查看绑定接口去拿token,向绑定页面发送\r\n                token: this.token,\r\n                saleName: this.saleName\r\n              }\r\n            })\r\n            break\r\n          //表示手机号和微信未绑定\r\n          case !isBind:\r\n            goRouter({\r\n              path: '/wx_user/userBindWx',\r\n              query: {\r\n                role: this.role,\r\n                openid: this.openid,\r\n                entry: this.entry,\r\n                salePhone: this.salePhone || this._salePhone\r\n              }\r\n            })\r\n            break\r\n          default:\r\n            Toast({message: '登录失败请稍后重试！', duration: 3000})\r\n            break\r\n        }\r\n      },\r\n      initQrcode() {\r\n        if (this.queryObj.state.length === 11 && this.$route.query.bindEntry !== 'qrcode') {\r\n          this.entry = 'qrcode'\r\n          this._salePhone = this.queryObj.state.toString()\r\n        }\r\n      },\r\n//      goChildrenRoute(state) {\r\n//        //跳转路由方法\r\n//        let goRouter = (url) => {\r\n//          this.$router.replace(url)\r\n//        }\r\n//        switch (state) {\r\n//          case '未绑定手机号,未注册':\r\n//            this.title = '绑定牙医abc账号'\r\n//            goRouter({path: '/wx_user/login', query: {role: 'doctor', openid: this.openid}})\r\n//            break\r\n//          case '未绑定手机号,已注册':\r\n//            this.title = '绑定牙医abc账号'\r\n//            goRouter({path: '/wx_user/login', query: {role: 'doctor', openid: this.openid}})\r\n//            break\r\n//          case '已绑定手机号(未绑定销售)，牙医':\r\n//            this.title = '绑定账号'\r\n//            goRouter({\r\n//              path: '/wx_user/bindinfo',\r\n//              query: {\r\n//                role: 'doctor',\r\n//                phone: this.phone,\r\n//                customerPhone: this.customerPhone,\r\n//                openid: this.openid,\r\n//                isBind: this.isBind\r\n//              }\r\n//            })\r\n//            break\r\n//          case '已绑定手机号(已绑定销售)，牙医':\r\n//            this.title = '绑定账号'\r\n//            goRouter({path: '/wx_user/bindinfo', query: {role: 'doctor', bindInfo, openid: this.openid}})\r\n//            break\r\n//          case '未绑定手机号(未注册)，客户代表':\r\n//            this.title = '绑定账号'\r\n//            goRouter({path: '/wx_user/login', query: {role: 'sale', openid: this.openid}})\r\n//            break\r\n//          case '未绑定手机号(已注册)，客户代表':\r\n//            this.title = '绑定账号'\r\n//            goRouter({path: '/wx_user/bindinfo', query: {role: 'sale', bindInfo, openid: this.openid}})\r\n//            break\r\n//          default:\r\n//            Toast({message: '登录失败请稍后重试！', duration: 3000})\r\n//            this.title = '登录失败请稍后重试'\r\n//            break\r\n//        }\r\n//      },\r\n\r\n      //获取查询自符串并保存到queryObj对象中\r\n      getQueryObj() {\r\n        //获取为网页查询字符串\r\n        let queryObj = {}\r\n        let query = window.location.search.split('?')[1] || ''\r\n        query.replace(/(\\w+)=(\\w*)/g, ($1, $2, $3) => {\r\n          queryObj[$2] = $3;\r\n        })\r\n        this.queryObj = queryObj\r\n      },\r\n    },\r\n    created() {\r\n      Toast({message: '正在验证身份信息，请稍后', duration: 1000})\r\n      //获取查询字符串中的code值\r\n      this.getQueryObj()\r\n      //扫码登录进来的\r\n//      this.role = this.$route.query.role\r\n      //获得入口方式\r\n      this.initQrcode()\r\n      //判断入口\r\n      console.info('user组件中的query', this.$route.query)\r\n      if (this.$route.query.bindEntry === 'qrcode') {\r\n        this.entry = ''\r\n        //todo 验证这步是否出现问题\r\n        this.openid = this.$route.query.openid\r\n        console.log(this.openid)\r\n        this.goChildrenRoute(this.isBind)\r\n      } else {\r\n        //请求微信openid值和绑定信息\r\n        Indicator.open()\r\n        this.$store.dispatch(GET_USER_WX_STATE, {code: this.queryObj.code})\r\n          .then(res => {\r\n            Indicator.close()\r\n            this.openid = res.data.sNSUserInfo.openId\r\n            //表示微信已经和用户绑定\r\n            if (+res.data.sNSUserInfo.sign === 1) this.isBind = true\r\n\r\n            if (this.isBind) {\r\n              //判断角色的两种doctor和sale\r\n              if (+res.data.wXUserLibk.type === 1) this.role = 'doctor'\r\n              if (+res.data.wXUserLibk.type === 2) this.role = 'sale'\r\n              //获取到用户的一些信息 data可能为空\r\n              let data = res.data.user\r\n              if (data && data.saleinfo) this.isBindSale = true\r\n              //TODO 这里写saleName\r\n              if (data && data.saleinfo) this.saleName = data.saleinfo.trueName || '未知'\r\n              if (data) {\r\n                this.salePhone = data.saleinfo && data.saleinfo.phone\r\n                this.phone = data.phone\r\n              }\r\n              if (this.role === 'sale') this.phone = res.data.saleInfo.phone\r\n              tokenMethods.setToken(res.token)\r\n              this.token = res.token\r\n            }\r\n            //根据绑定信息跳转路由\r\n            this.goChildrenRoute(this.isBind)\r\n          })\r\n          .catch(err => {\r\n            Toast({message: '身份验证出现问题，请稍后', duration: 3000})\r\n            console.log(err)\r\n//          setTimeout(() => {\r\n//            this.$router.go(-1)\r\n//          }, 5000)\r\n          })\r\n      }\r\n    },\r\n    mounted() {\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .user-container {\r\n    position: relative;\r\n  }\r\n\r\n  .content {\r\n    margin-top: 6vh;\r\n  }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// user.vue?eb1ec7f6","exports = module.exports = require(\"../../../node_modules/_css-loader@0.28.7@css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".user-container[data-v-263ef3ca]{position:relative}.content[data-v-263ef3ca]{margin-top:6vh}\", \"\", {\"version\":3,\"sources\":[\"D:/yayiApp/src/components/wx_user/user.vue\"],\"names\":[],\"mappings\":\"AACA,iCACE,iBAAmB,CACpB,AACD,0BACE,cAAgB,CACjB\",\"file\":\"user.vue\",\"sourcesContent\":[\"\\n.user-container[data-v-263ef3ca] {\\n  position: relative;\\n}\\n.content[data-v-263ef3ca] {\\n  margin-top: 6vh;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_css-loader@0.28.7@css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/_vue-loader@12.2.2@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-263ef3ca\",\"scoped\":true,\"hasInlineConfig\":false}!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./src/components/wx_user/user.vue\n// module id = 987\n// module chunks = 82"],"sourceRoot":""}